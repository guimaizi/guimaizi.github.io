<!doctype html>

<html lang="en-us">

<head>
  <title>guimaizi&#39;s blog</title>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="The HTML5 Herald" />
<meta name="author" content="" /><meta property="og:title" content="从前" />
<meta property="og:description" content="title: puppeteer异步并发方案 url: 535.html id: 535 comments: false categories:
 安全/代码 date: 2019-10-04 23:16:18 tags:    博主是一名优秀的爬虫师,欢迎联系博主交流爬虫技术。
 关于puppeteer的并发方案: node代码:
const puppeteer = require(&#39;puppeteer&#39;); async function process_page(page){ //page.evaluate(() =&gt; alert(document.domain)); await page.on(&#39;dialog&#39;, async dialog =&gt; { await dialog.dismiss();}) console.log(page.url()); await page.close(); } async function process_queue(browser,page,list_url){ await page.evaluate(list_url =&gt; { for(i=0;i&lt;list_url.length;i&#43;&#43;){ window.open(list_url[i]); } return 1; },list_url); while(allPages=await browser.pages(),allPages.length-2&lt;list_url.length){ await page.waitFor(3000); } for(j=0;j&lt;allPages.length;j&#43;&#43;){ if (allPages[j]!=page){ process_page(allPages[j]); } } } (async () =&gt; { try { const list_url=[&#39;https://www." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.guimaizi.com/posts/puppeteer-e5-bc-82-e6-ad-a5-e5-b9-b6-e5-8f-91-e6-96-b9-e6-a1-88/" />
<meta property="article:published_time" content="2020-06-06T22:23:20+08:00" />
<meta property="article:modified_time" content="2020-06-06T22:23:20+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="从前"/>
<meta name="twitter:description" content="title: puppeteer异步并发方案 url: 535.html id: 535 comments: false categories:
 安全/代码 date: 2019-10-04 23:16:18 tags:    博主是一名优秀的爬虫师,欢迎联系博主交流爬虫技术。
 关于puppeteer的并发方案: node代码:
const puppeteer = require(&#39;puppeteer&#39;); async function process_page(page){ //page.evaluate(() =&gt; alert(document.domain)); await page.on(&#39;dialog&#39;, async dialog =&gt; { await dialog.dismiss();}) console.log(page.url()); await page.close(); } async function process_queue(browser,page,list_url){ await page.evaluate(list_url =&gt; { for(i=0;i&lt;list_url.length;i&#43;&#43;){ window.open(list_url[i]); } return 1; },list_url); while(allPages=await browser.pages(),allPages.length-2&lt;list_url.length){ await page.waitFor(3000); } for(j=0;j&lt;allPages.length;j&#43;&#43;){ if (allPages[j]!=page){ process_page(allPages[j]); } } } (async () =&gt; { try { const list_url=[&#39;https://www."/>

<meta name="generator" content="Hugo 0.72.0" />
    

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
  <link rel="stylesheet" href="http://www.guimaizi.com/fontawesome/css/all.min.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  <link rel="stylesheet" type="text/css" href="/css/styles.css" /></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="/">guimaizi&rsquo;s blog</a>
            </h1>

      <ul id="social-media">
      </ul>
      
    </header>

    
<nav>
    <ul>
        
    </ul>
</nav>


    <main>




<article>

    <h1>从前</h1>

    
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-06-06T22:23:20&#43;08:00">Jun 6, 2020</time>
        </li>
        

        

        <li>One minute read</li>
    </ul>
</aside>

    

    


    <hr>
<p>title: puppeteer异步并发方案
url: 535.html
id: 535
comments: false
categories:</p>
<ul>
<li>安全/代码
date: 2019-10-04 23:16:18
tags:</li>
</ul>
<hr>
<blockquote>
<p>博主是一名优秀的爬虫师,欢迎联系博主交流爬虫技术。</p>
</blockquote>
<p>关于puppeteer的并发方案: node代码:</p>
<pre><code>const puppeteer = require('puppeteer');
async function process_page(page){
    //page.evaluate(() =&gt; alert(document.domain));
    await page.on('dialog', async dialog =&gt; {
        await dialog.dismiss();})
    console.log(page.url());
    await page.close();
}
async function process_queue(browser,page,list_url){
    await page.evaluate(list_url =&gt; {
        for(i=0;i&lt;list_url.length;i++){
        window.open(list_url[i]);
        }
        return 1;
    },list_url);
    while(allPages=await browser.pages(),allPages.length-2&lt;list_url.length){
        await page.waitFor(3000);
}
    for(j=0;j&lt;allPages.length;j++){
        if (allPages[j]!=page){
        process_page(allPages[j]);
    }
    }
}
(async () =&gt; {
  try {
        const list_url=['https://www.w3school.com.cn/js/js_loop_for.asp','http://www.voidcn.com/article/p-stvclize-bte.html',
        'https://xiday.com/2019/09/21/puppeteer-run-js/','https://im.qq.com/','http://192.168.0.225/vul/frame221.html','https://en.mail.qq.com/','https://www.1688.com/',
    'https://github.com/','https://www.baidu.com/','http://www.guimaizi.com/','https://fanyi.baidu.com/?aldtype=16047#auto/zh','http://es6.ruanyifeng.com/#docs/promise',
'https://security.alibaba.com/','https://security.alipay.com/home.htm','https://security.pingan.com/','https://bugbounty.huawei.com/hbp/#/home'];
        const browser = await puppeteer.launch({
            headless: false,
            slowMo:150,
            timeout:5000});
        const page = await browser.newPage();
        set_list=[]
        for(i=0;i&lt;list_url.length;i++){
            if(set_list.length&gt;=5){
            console.log(set_list);
            await process_queue(browser,page,set_list)
            set_list=[];
        }
        set_list.push(list_url[i]);
    }
        console.log(set_list)
        await process_queue(browser,page,set_list)
        //await browser.close();
} catch (err) {
  console.error(err);
  //await browser.close();
}
})();
</code></pre>
<p>如果对您有帮助，请打赏杯奶茶吧 微信支付: <img src="https://raw.githubusercontent.com/guimaizi/cloud/test/img20191004231305.jpg" alt=""></p>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="http://www.guimaizi.com/posts/python3-e8-af-ad-e9-9f-b3-e6-8f-90-e7-a4-ba-e8-82-a1-e7-a5-a8-e4-bb-b7-e6-a0-bc/"><i class="fa fa-chevron-circle-left"></i> 从前</a>
        </li>
        
        
        <li>
            <a href="http://www.guimaizi.com/posts/ncov-2019/">从前 <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
  
    
    
  





</main>
    <footer>
        <h6> |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="http://www.guimaizi.com/index.xml">Subscribe </a></h6>
    </footer>
</div>
<script src="/js/scripts.js"></script>

</body>

</html>

