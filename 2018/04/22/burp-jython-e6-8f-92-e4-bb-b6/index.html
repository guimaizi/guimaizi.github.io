<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>burp-jython-插件 | guimaizi&#39;s blog</title>
	<link rel="stylesheet" href="/css/style.css" />
	
      <link rel="alternate" href="/atom.xml" title="guimaizi&#39;s blog" type="application/atom+xml">
    
<meta name="generator" content="Hexo 4.2.0"></head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/archives" class="header__link">Archive</a>
			
				<a href="/tags" class="header__link">Tags</a>
			
				<a href="/atom.xml" class="header__link">RSS</a>
			
		</nav>
		<h1 class="header__title"><a href="/">guimaizi&#39;s blog</a></h1>
		<h2 class="header__subtitle">道心不改,灵台无尘。</h2>
	</header>

	<main>
		<article>
	
		<h1>burp-jython-插件</h1>
	
	<div class="article__infos">
		<span class="article__date">2018-04-22</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/%E5%AE%89%E5%85%A8-%E4%BB%A3%E7%A0%81/">安全/代码</a>
			</span><br />
		
		
	</div>

	

	
		<p>功能:把burp获取的数据转换为json保存进tmp.json(有个bug、可能因为java的原因，保存的json数据是单引号，非标准json格式，需要re.sub(‘\‘’,’\“‘,f.read())把单引号转为双引号，如图二。）</p>
<p><figure class="figure"><img src="http://oswqkbo28.bkt.gdipper.com/2.png" alt=""></figure></p>
<p><figure class="figure"><img src="http://oswqkbo28.bkt.gdipper.com/1.png" alt=""></figure></p>
<p># coding: utf-8<br>‘’’<br>@author: guimaizi<br>‘’’<br>from burp import IBurpExtender<br>from burp import IContextMenuFactory<br>from burp import IBurpExtenderCallbacks<br>from burp import IContextMenuInvocation<br>from burp import IHttpRequestResponse<br>from javax.swing import JMenuItem<br>import os</p>
<p>class BurpExtender(IBurpExtender,  IContextMenuFactory):</p>
<pre><code>def registerExtenderCallbacks(self, callbacks):
    self.\_actionName = &quot;test\_vul&quot;
    self._helers = callbacks.getHelpers()
    self._callbacks = callbacks
    callbacks.setExtensionName(&quot;test_vul&quot;)
    callbacks.registerContextMenuFactory(self)
    return 

def createMenuItems(self, invocation):
    menu = \[\]
    responses = invocation.getSelectedMessages()
    if len(responses) == 1:
        menu.append(JMenuItem(self._actionName, None , actionPerformed= lambda x, inv=invocation: self.Action(inv)))
        return menu
    return None

def Action(self, invocation):
    request = invocation.getSelectedMessages().pop()
    analyzedRequest = self._helers.analyzeRequest(request)
    url = analyzedRequest.url
    body = &quot;&quot;
    cookie = &quot;&quot;
    referer = &quot;&quot;
    useragent = &quot;&quot;
    headers = analyzedRequest.getHeaders()
    for header in headers:
        if header.startswith(&quot;Cookie: &quot;):
            cookie = header.replace(&quot;Cookie: &quot;,&quot;&quot;)
        elif header.startswith(&quot;Referer: &quot;):
            referer = header.replace(&quot;Referer: &quot;,&quot;&quot;)
        elif header.startswith(&quot;User-Agent: &quot;):
            useragent = header.replace(&quot;User-Agent: &quot;,&quot;&quot;)
    if analyzedRequest.getMethod() == &quot;POST&quot;:
        body = request.getRequest().tostring()\[analyzedRequest.getBodyOffset():\]
    test\_vul = &quot;E:/hack/burp\_lib/test_vul.py&quot;        
    cmd={&quot;url&quot;:str(url),&quot;body&quot;:str(body),&quot;cookie&quot;:str(cookie),&quot;useragent&quot;:str(useragent),&quot;referer&quot;:str(referer)}
    print cmd
    fo = open(&quot;E:/hack/burp_lib/tmp.json&quot;, &quot;w&quot;)
    fo.write(str(cmd))
    fo.close()
    os.system(&apos;start cmd /k &apos;+test_vul)</code></pre>
	

	
		<span class="different-posts"><a href="/2018/04/22/burp-jython-e6-8f-92-e4-bb-b6/" onclick="window.history.go(-1); return false;">⬅️ Go back </a></span>

	

</article>

	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<p>Hi there, <br />welcome to my Blog glad you found it. Have a look around, will you?</p>
</div>

	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>© 2020 guimaizi | Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> | Theme <a href="https://github.com/HoverBaum/meilidu-hexo" target="_blank" rel="noopener">MeiliDu</a></span>
		</div>

	</div>


</footer>



</body>

</html>
