<!doctype html>

<html lang="en-us">

<head>
  <title>guimaizi&#39;s blog</title>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="The HTML5 Herald" />
<meta name="author" content="" /><link rel="alternate" type="application/rss+xml+xml" href="https://www.guimaizi.com/index.xml" title="guimaizi's blog" /><meta property="og:title" content="guimaizi&#39;s blog" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.guimaizi.com/" />
<meta property="og:updated_time" content="2020-07-19T14:44:18+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="guimaizi&#39;s blog"/>
<meta name="twitter:description" content=""/>

<meta name="generator" content="Hugo 0.74.3" />
    

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://www.guimaizi.com/fontawesome/css/all.min.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  <link rel="stylesheet" type="text/css" href="/css/styles.css" /></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="/">guimaizi&rsquo;s blog</a>
            </h1>

      <ul id="social-media">
             <li>
               <a href="https://github.com/guimaizi" title="GitHub">
               <i class="fab fa-github fa-lg"></i>
               </a>
             </li>
             <li>
               <a href="https://twitter.com/guimaizi" title="Twitter">
               <i class="fab fa-twitter fa-lg"></i>
               </a>
             </li>
      </ul>
      
    </header>

    
<nav>
    <ul>
        
    </ul>
</nav>


    <main>




<section id="home">
  <ul>
    
    
    

    <li class="first" >
      <h1><a href="https://www.guimaizi.com/posts/e5-9f-9f-e5-90-8d-e6-94-b6-e9-9b-86-e4-b8-8e-e7-9b-91-e6-b5-8bv3-0/" title="从前">从前</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-06-06T22:23:20&#43;08:00">Jun 6, 2020</time>
        </li>
        

        

        <li>One minute read</li>
    </ul>
</aside>

      

      <p>title: 域名收集与监测V3.0 url: 479.html id: 479 comments: false categories:
 安全/代码 date: 2019-06-25 12:07:28 tags:   github:https://github.com/guimaizi/get_domain
简介 在职业刷src或者apt攻击者的角度，单单过一遍爆破的域名是不能满足持续性漏洞挖掘;从职业刷src的角度，过一遍收集的子域名，已经发现了所有漏洞并已经提交后修复，或者用当前漏洞测试方法并没发现有漏洞，这样业务是安全的，但这个安全是在当下时间的，企业要发展、要解决当前问题，就会出新业务、或者不断的修复更新旧问题，这就是业务的变化，通过持续性监控子域名就会发现业务的变化，最快速度的发现变化，对变化进行安全测试、漏洞挖掘。有经验的刷src的同学都知道，新业务发现漏洞概率都很高。
环境配置 需要环境: * win10/8/7/xp
其他请自行修改代码、反正是开源，改动也不大。 * python3
python3.5+ 自行官方下载 * mongodb
自行官方下载 建议docker搭建 参考:https://www.jianshu.com/p/6fdb2bcb4b43 * chrome
自行官方下载 * chromedriver
下载成功后放入python根目录或加入全局环境变量
chromedriver下载地址:http://npm.taobao.org/mirrors/chromedriver/ 注:与当前chrome匹配 * subfinder
https://github.com/subfinder/subfinder win默认带有,其他请自行修改代码。 以上配置完成,切进项目目录
pip 安装requirements.txt
 pip install -r requirements.txt
 设置config.json
{ &quot;path&quot;:&quot;E:/code/test1&quot;, //项目所在绝对路径 &quot;target_json&quot;:&quot;E:/code/test1/target/qq.json&quot;, //目标域名文件绝对路径 &quot;chrome_path&quot;:&quot;C:/Program Files (x86)/Google/Chrome/Application/chrome.exe&quot;, //chrome文件绝对路径 &quot;timeout&quot;:8, //全局超时设置,建议大于5 &quot;mongo_config&quot;:{&quot;ip&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:27017,&quot;name&quot;:&quot;&quot;,&quot;password&quot;:&quot;&quot;} //mongodb 配置,ip 端口 name passwrod 空密码时name pwd设置为空 }  设置目标域名文件</p>
      
      <a href="/posts/e5-9f-9f-e5-90-8d-e6-94-b6-e9-9b-86-e4-b8-8e-e7-9b-91-e6-b5-8bv3-0/">Read more…</a>
      
    </li>
    

    <li >
      <h1><a href="https://www.guimaizi.com/posts/e5-9f-9f-e5-90-8d-e7-9b-91-e6-8e-a7-e8-84-91-e5-9b-be-e5-88-86-e4-ba-ab/" title="从前">从前</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-06-06T22:23:20&#43;08:00">Jun 6, 2020</time>
        </li>
        

        

        <li>One minute read</li>
    </ul>
</aside>

      

      <p> title: 域名监控脑图分享 url: 468.html id: 468 comments: false categories:
 安全/代码 date: 2019-06-14 11:21:37 tags:   </p>
      
    </li>
    

    <li >
      <h1><a href="https://www.guimaizi.com/posts/e5-a4-9c-e7-ac-99-e6-ad-8c-e6-9c-89-e6-84-9f/" title="从前">从前</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-06-06T22:23:20&#43;08:00">Jun 6, 2020</time>
        </li>
        

        

        <li>One minute read</li>
    </ul>
</aside>

      

      <p>title: 夜笙歌有感 url: 323.html id: 323 comments: false categories:
 思想 生活 date: 2018-10-12 23:46:08 tags:   哭啼啼哭啼啼，孩童落地哭两语。
恨啾啾悔啾啾，一转轮回又一生。</p>
      
    </li>
    

    <li >
      <h1><a href="https://www.guimaizi.com/posts/e5-a6-82-e4-bd-95-e5-83-8f-e6-88-91-e4-b8-80-e6-a0-b7-e5-88-b7-e8-85-be-e8-ae-af-e9-ab-98-e5-8d-b1/" title="从前">从前</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-06-06T22:23:20&#43;08:00">Jun 6, 2020</time>
        </li>
        

        

        <li>One minute read</li>
    </ul>
</aside>

      

      <p> title: 如何像我一样刷腾讯高危 url: 336.html id: 336 comments: false categories:
 安全/代码 date: 2018-11-15 14:24:25 tags:    修改cookie uin到指定qq号 绕过登陆
 好了，打完收工，不挖了~江湖再见！ </p>
      
    </li>
    

    <li >
      <h1><a href="https://www.guimaizi.com/posts/e5-a6-82-e4-bd-95-e5-83-8f-e6-88-91-e4-b8-80-e6-a0-b7-e5-88-b7-e8-85-be-e8-ae-afxss/" title="从前">从前</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-06-06T22:23:20&#43;08:00">Jun 6, 2020</time>
        </li>
        

        

        <li>One minute read</li>
    </ul>
</aside>

      

      <p> title: 如何像我一样刷腾讯xss url: 334.html id: 334 comments: false categories:
 安全/代码 date: 2018-11-15 14:14:02 tags:   请看以下js:
&lt;div id=&quot;c&quot; style=&quot;margin:40px auto 0px;width:600px;text-align:center;&quot;&gt;&lt;/div&gt; &lt;script&gt; function GetQueryString(name) { var reg = new RegExp(&quot;(^|&amp;)&quot;+ name +&quot;=([^&amp;]*)(&amp;|$)&quot;); var r = window.location.search.substr(1).match(reg); if(r!=null)return decodeURIComponent(r[2]); return null; } var r=GetQueryString('r'); var reg = /^http:\/\/((.*\.qq\.com)|(localhost))\/.*]/i; if (reg.test(r)) { document.getElementById('c').innerHTML='欢迎您，454454545454'+'，&lt;a href=&quot;'+r+'&quot;&gt;返回活动&lt;/a&gt;'; } else { window.location=r; } &lt;/script&gt;  payload:
'&quot;&gt;&lt;img src=a onerror=alert()&gt; javascript:alert() </p>
      
    </li>
    

    <li >
      <h1><a href="https://www.guimaizi.com/posts/e5-a6-82-e4-bd-95-e8-89-ba-e6-9c-af-e7-9a-84-e5-88-b7src/" title="从前">从前</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-06-06T22:23:20&#43;08:00">Jun 6, 2020</time>
        </li>
        

        

        <li>One minute read</li>
    </ul>
</aside>

      

      <p>title: 如何艺术的刷src url: 321.html id: 321 comments: false categories:
 安全/代码 date: 2018-10-10 22:00:10 tags:    作为一个刷src老油条来说下我的经验，我是13年开始刷src的，蝉联宇宙最厉害src tsrc四年的前五，最好成绩是第三-.-''',积分制上有一年的第一。
 13、14年那时候真的是如果稍微有点编程功底基本就可以制霸各大src，那个时代甚至好多厂家没有waf(web防火墙)的概念，而web2.0时代才刚开始一段时间，xss、sql、命令注入、代码执行、越权、弱口令什么鬼的到处都是，所以出了很多从零开始的黑客，历练到今年，基本都已经是独当一面的安全工程师，甚至有的还很出名很牛逼很有钱，16、17年开始行业不一样了，从以前厂商裸奔到waf的普及和安全意识的转变，然后刷src人士就不好过了，一个xss都要先绕过waf，被政策施压、各种黑客的扫描测试、乙方厂家扫描测试，相对当年已经重视和安全了很多。
言归正传，刷src也就是批量挖漏洞，漏洞是如何产生？ 交互处常有漏洞，世界本来很安全，自从有了人，和他人，需要处理和他人各种逻辑关系时，就不安全了。
交互流程: 这个互联网就是基于这个逻辑而存在，就如同你论坛发帖，流程:要把文字编辑好提交(输入)-&gt;论坛服务器(处理数据:标识是谁发的、属于哪个版块、哪个时间)-&gt;保存进入数据库-&gt;调用数据库内数据展示(二次处理，根据标识或者时间顺序展示等)。要至少经过这一个流程你的帖子才能发表在论坛上。
&lt;?php /* php xss 漏洞案例 文件名:1.php 触发:www.xxx.com/1.php?xss=[evilcode] */ echo $GET_['XSS']; ?&gt;  以上是xss漏洞的交互逻辑:输入(从表单输入)-处理(前端、后端逻辑处理)-展示，漏洞在于处理输入的数据时没有考虑到数据中可能出现的风险，所以漏洞不在于输入时和展示时，而在于处理时，就如例直接展示输入的数据就造成了xss漏洞。
漏洞是在处理时，而没有输入也不会有处理，这是个有鸡还是先有蛋的问题，这个流程才是风险的所在，那么刷src艺术的关键就在寻找这个流程，就是寻找输入点，寻找到的输入点越多，你找到漏洞的可能性越大，他的流程越是复杂，你能在这一个流程上找到漏洞就越多。
寻找web流程/输入点(web前期情报收集) 如何刷src的第一步就是如何寻找这个流程，web常规流程:
(数据由人输入)-&gt;(经过http/https传输至)-&gt;(web服务器apache/nginx/iis接收并解码)-&gt;(脚本语言处理数据) 这就是一个能接受数据的web服务(网站)，可以通过域名/IP访问。
 域名:*.org *.com *.cn *.gov *.[a-Z]
IP:IPV4 0.0.0.0-255.255.255.255 IPV6 0:0:0:0:0:0:0:0 → ::
 **_域名的规则_** : *.gov结尾的都是政府的web服务(网站)、*.edu结尾的都是学校/教育机构的web服务(网站),比如www.gov.cn(中国政府网) www.pku.edu.cn(北京大学)，因为是中国的网站所以结尾多出了.cn,互联网企业都会拥有域名如:www.qq.com www.168.com,而因为业务庞大繁多等原因，域名都会出现多个子域名如*.qq.com *.163.com。 ![iYMGcD.png](https://s1.ax1x.com/2018/10/09/iYMGcD.png) 如图，子域名繁多，功能不一，都是完整web服务流程，而入口的区别只在于 \[\].qq.com 括号内0-9a-Z的组合。 IP的规则 :大家都有使用过路由器，很多人还操作过，一个家用路由器分配的ip:192.168.0.1-192.168.255.255,而分配的这些ip就叫做 ip段</p>
      
      <a href="/posts/e5-a6-82-e4-bd-95-e8-89-ba-e6-9c-af-e7-9a-84-e5-88-b7src/">Read more…</a>
      
    </li>
    

    <li >
      <h1><a href="https://www.guimaizi.com/posts/e5-ad-90-e5-9f-9f-e5-90-8d-e7-9b-91-e6-8e-a7/" title="从前">从前</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-06-06T22:23:20&#43;08:00">Jun 6, 2020</time>
        </li>
        

        

        <li>One minute read</li>
    </ul>
</aside>

      

      <p> title: 子域名监控 url: 349.html id: 349 comments: false categories:
 安全/代码 date: 2018-12-05 22:23:01 tags:   域名监控概括 子域名收集这个路子真的是被玩烂了，花样百出、工具没有八百也有一千，无非是爆破、爬、调用搜索引擎之类，有资源的大厂有自己的dns库，但是这些在我眼里真的都很low。
为什么说很low，因为在职业刷src或者apt攻击者的角度，单单过一遍爆破的域名是不能满足**_持续性_**漏洞挖掘的;从职业刷src的角度，过一遍收集的子域名，已经发现了所有漏洞并已经提交后修复，或者用当前漏洞测试方法并没发现有漏洞，这样业务是安全的，但这个安全是在当下时间的，企业要发展、要解决当前问题，就会出新业务不断的pull代码更新旧问题，**_这就是业务的变化，通过持续性监控子域名就会发现业务的变化，最快速度的发现变化，对变化进行安全测试、漏洞挖掘_**。有经验的刷src的同学都知道，新业务发现漏洞概率都很高。
懒惰使人创造工具，而我就拥有这么一个工具，从14年搞的子域名爆破工具(送给过一个小姐姐，刷了好多漏，如今以身为人妻，而我还没有女朋友。)，到如今的子域名监控工具。
具体实现思路 1、通过域名爆破、搜索引擎之类方法，获得子域名后爬取子域名http响应数据保存入数据库。
2、设定时间、可以是一分钟、一小时、一天一次循环读取库内子域名，进行爬取子域名和库类http响应数据对比，对比出变化推送提醒。
 从思路上是个简单的工具，但是我的集成chrome headless、subfinder，自我感觉mongodb的可视化也不错，操作便捷、使用稳定。 结果类似图上，正式版本title不会出现乱码。
 功能: 通过爆破、爬取收集子域名，之后循环爬取库内数据对比发现业务的变化和新业务后及时展示、推送。 域名黑名单机制，可设置过滤_.ke.qq.com、_.qzone.qq.com、*.bz.qq.com之类n级子域泛解析。
  上面说了一大堆，重点来了，最近略穷，试用版价格只要200人民币，不是美元、不是比特币，只要一个微信红包价格,有意请联系以下微信: </p>
      
    </li>
    

    <li >
      <h1><a href="https://www.guimaizi.com/posts/e5-ad-90-e5-9f-9f-e5-90-8d-e7-9b-91-e6-b5-8b-e6-ba-90-e7-a0-81-e4-b8-8e-e7-8e-af-e5-a2-83-e6-90-ad-e5-bb-ba/" title="从前">从前</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-06-06T22:23:20&#43;08:00">Jun 6, 2020</time>
        </li>
        

        

        <li>One minute read</li>
    </ul>
</aside>

      

      <p>title: 子域名监测源码与环境搭建 url: 360.html id: 360 comments: false categories:
 安全/代码 date: 2018-12-06 21:44:03 tags:   环境要求: ubuntu 64位
python3 go mongodb chrome chromedriver
代码下载链接: https://pan.baidu.com/s/18cR0wmJR7X3ukT6GQyynKQ 提取码: 26k6
代码结构: browser.py 浏览器功能 获取html、执行js等 config.py 配置文件，一些需要的功能 mongodb_con.py mongo连接文件 start.py 开始爆破和爬取子域名获取http响应入mongo库 while_update.py 域名监测功能、遍历mongo库内数据 对比出变化域名和爬取新域名 \subfinder 用来启动最初爆破子域名 \tmp 存放browser爬取的 href network请求的url \target 存放要监测域名的配置信息  注意 因为获取http响应的是基于chrome浏览器，模拟chrome访问，并且访问后进行多个javascript执行，所以访问每个url会比普通urllib时间要长很多，所以我添加了简易版chrome线程池以便进行多线程同步访问以便加快速度，默认是5个chrome同时模拟访问。
环境搭建 必须执行 cd 进扫描器目录
sudo sh install.sh
 install.sh内代码:
sudo apt-get install mongodb golang git python3 python3-pip xvfb unzip libxss1 libappindicator1 libindicator7 -y</p>
      
      <a href="/posts/e5-ad-90-e5-9f-9f-e5-90-8d-e7-9b-91-e6-b5-8b-e6-ba-90-e7-a0-81-e4-b8-8e-e7-8e-af-e5-a2-83-e6-90-ad-e5-bb-ba/">Read more…</a>
      
    </li>
    

    <li >
      <h1><a href="https://www.guimaizi.com/posts/e5-ad-90-e5-9f-9f-e5-90-8d-e9-9a-8f-e6-9c-ba-e6-94-b6-e9-9b-86/" title="从前">从前</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-06-06T22:23:20&#43;08:00">Jun 6, 2020</time>
        </li>
        

        

        <li>2 minutes read</li>
    </ul>
</aside>

      

      <p>title: 子域名随机收集 url: 325.html id: 325 comments: false categories:
 安全/代码 date: 2018-10-16 18:51:25 tags:    取随机数随机组合出(0-9 a-z .)字符串，dns穷举子域名
需要环境python3.5+ mongodb、别的自己pip install *
本来是异步的、但是requests会阻塞就线程了。
超时时间和线程数识网络环境自己设置
 # coding: utf-8 ''' Created on 2018年10月15日 @author: guimaizi ''' import dns.resolver,requests,random,queue,time,threadpool from pymongo import MongoClient from bs4 import BeautifulSoup class start: def __init__(self,domain): ''' :domian 子域名收集 ''' self.domain=domain #超时 self.timeout=5 #线程数 self.thread_num=100 self.domain_list=[] self.result=[] #每次任务标记 self.random=self.generate_random_str(16) def generate_random_str(self,randomlength): &quot;&quot;&quot; :randomlength 生成一个指定长度的随机字符串 &quot;&quot;&quot; random_str = '' base_str = 'abcdefghigklmnopqrstuvwxyz0123456789.</p>
      
      <a href="/posts/e5-ad-90-e5-9f-9f-e5-90-8d-e9-9a-8f-e6-9c-ba-e6-94-b6-e9-9b-86/">Read more…</a>
      
    </li>
    

    <li >
      <h1><a href="https://www.guimaizi.com/posts/e5-ae-8f-e8-a7-82-e7-bb-8f-e6-b5-8e-e5-88-86-e6-9e-90/" title="从前">从前</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-06-06T22:23:20&#43;08:00">Jun 6, 2020</time>
        </li>
        

        

        <li>One minute read</li>
    </ul>
</aside>

      

      <p>title: 经济政策分析-2018.4.24 url: 169.html id: 169 comments: false categories:
 a股/金融 政治/经济 date: 2018-04-24 11:24:14 tags:   说好的在全球经济向好的情况下&quot;去杠杆&quot;被特朗普贸易战毁了，昨天的《习近平主持中共中央政治局会议 分析研究当前经济形势和经济工作》改变前一阶段的信贷紧缩去杠杆政策，开始着重提到拉动内需，稳健中性的货币政策，今早沪深a股涨2个点，周期股居前。
参考:http://www.gov.cn/xinwen/2018-04/23/content_5285191.htm</p>
      
    </li>
    
  </ul>
</section>


<ul class="pagination">
  <li class="page-item">
    <a href="/" class="page-link" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
  </li>
  <li class="page-item">
    <a href="/page/13/" class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
  </li>
  <li class="page-item">
    <a class="page-link" href="/">1</a>
  </li>
  <li class="page-item">
    <a class="page-link" href="/page/2/">2</a>
  </li>
  <li class="page-item">
    <a class="page-link" href="/page/3/">3</a>
  </li>
  <li class="page-item disabled">
    <span aria-hidden="true">&nbsp;&hellip;&nbsp;</span>
  </li>
  <li class="page-item">
    <a class="page-link" href="/page/13/">13</a>
  </li>
  <li class="page-item active">
    <a class="page-link" href="/page/14/">14</a>
  </li>
  <li class="page-item">
    <a class="page-link" href="/page/15/">15</a>
  </li>
  <li class="page-item disabled">
    <span aria-hidden="true">&nbsp;&hellip;&nbsp;</span>
  </li>
  <li class="page-item">
    <a class="page-link" href="/page/19/">19</a>
  </li>
  <li class="page-item">
    <a href="/page/15/" class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
  </li>
  <li class="page-item">
    <a href="/page/19/" class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
  </li>
</ul>





</main>
    <footer>
        <h6> |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="https://www.guimaizi.com/index.xml">Subscribe </a></h6>
    </footer>
</div>
<script src="/js/scripts.js"></script>

</body>

</html>

