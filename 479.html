<!DOCTYPE html>
<html lang="en-us">
<head>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">

<title>域名收集与监测V3.0 - guimaizi&#39;s blog</title>
<meta name="description" content="">

<link rel="icon" type="image/x-icon" href="http://www.guimaizi.com/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="http://www.guimaizi.com/favicon.png">

<link rel="stylesheet" href="http://www.guimaizi.com/css/style.css?rnd=1591500952" />



<meta property="og:title" content="域名收集与监测V3.0" />
<meta property="og:description" content="github:https://github.com/guimaizi/get_domain
简介 在职业刷src或者apt攻击者的角度，单单过一遍爆破的域名是不能满足持续性漏洞挖掘;从职业刷src的角度，过一遍收集的子域名，已经发现了所有漏洞并已经提交后修复，或者用当前漏洞测试方法并没发现有漏洞，这样业务是安全的，但这个安全是在当下时间的，企业要发展、要解决当前问题，就会出新业务、或者不断的修复更新旧问题，这就是业务的变化，通过持续性监控子域名就会发现业务的变化，最快速度的发现变化，对变化进行安全测试、漏洞挖掘。有经验的刷src的同学都知道，新业务发现漏洞概率都很高。
环境配置 需要环境: * win10/8/7/xp
其他请自行修改代码、反正是开源，改动也不大。 * python3
python3.5&#43; 自行官方下载 * mongodb
自行官方下载 建议docker搭建 参考:https://www.jianshu.com/p/6fdb2bcb4b43 * chrome
自行官方下载 * chromedriver
下载成功后放入python根目录或加入全局环境变量
chromedriver下载地址:http://npm.taobao.org/mirrors/chromedriver/ 注:与当前chrome匹配 * subfinder
https://github.com/subfinder/subfinder win默认带有,其他请自行修改代码。 以上配置完成,切进项目目录
pip 安装requirements.txt
 pip install -r requirements.txt
 设置config.json
{ &quot;path&quot;:&quot;E:/code/test1&quot;, //项目所在绝对路径 &quot;target_json&quot;:&quot;E:/code/test1/target/qq.json&quot;, //目标域名文件绝对路径 &quot;chrome_path&quot;:&quot;C:/Program Files (x86)/Google/Chrome/Application/chrome.exe&quot;, //chrome文件绝对路径 &quot;timeout&quot;:8, //全局超时设置,建议大于5 &quot;mongo_config&quot;:{&quot;ip&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:27017,&quot;name&quot;:&quot;&quot;,&quot;password&quot;:&quot;&quot;} //mongodb 配置,ip 端口 name passwrod 空密码时name pwd设置为空 }  设置目标域名文件
{ &quot;domain&quot;:&quot;.qq.com&quot;, //目标域名 必须是.xx.xxx 如.qq.com .163.com .126.net //子域名黑名单,解决泛解析问题 &quot;Blacklist_domain&quot;:[ &quot;." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.guimaizi.com/479.html" />
<meta property="article:published_time" content="2019-06-25T12:07:28+00:00" />
<meta property="article:modified_time" content="2019-06-25T12:07:28+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="域名收集与监测V3.0"/>
<meta name="twitter:description" content="github:https://github.com/guimaizi/get_domain
简介 在职业刷src或者apt攻击者的角度，单单过一遍爆破的域名是不能满足持续性漏洞挖掘;从职业刷src的角度，过一遍收集的子域名，已经发现了所有漏洞并已经提交后修复，或者用当前漏洞测试方法并没发现有漏洞，这样业务是安全的，但这个安全是在当下时间的，企业要发展、要解决当前问题，就会出新业务、或者不断的修复更新旧问题，这就是业务的变化，通过持续性监控子域名就会发现业务的变化，最快速度的发现变化，对变化进行安全测试、漏洞挖掘。有经验的刷src的同学都知道，新业务发现漏洞概率都很高。
环境配置 需要环境: * win10/8/7/xp
其他请自行修改代码、反正是开源，改动也不大。 * python3
python3.5&#43; 自行官方下载 * mongodb
自行官方下载 建议docker搭建 参考:https://www.jianshu.com/p/6fdb2bcb4b43 * chrome
自行官方下载 * chromedriver
下载成功后放入python根目录或加入全局环境变量
chromedriver下载地址:http://npm.taobao.org/mirrors/chromedriver/ 注:与当前chrome匹配 * subfinder
https://github.com/subfinder/subfinder win默认带有,其他请自行修改代码。 以上配置完成,切进项目目录
pip 安装requirements.txt
 pip install -r requirements.txt
 设置config.json
{ &quot;path&quot;:&quot;E:/code/test1&quot;, //项目所在绝对路径 &quot;target_json&quot;:&quot;E:/code/test1/target/qq.json&quot;, //目标域名文件绝对路径 &quot;chrome_path&quot;:&quot;C:/Program Files (x86)/Google/Chrome/Application/chrome.exe&quot;, //chrome文件绝对路径 &quot;timeout&quot;:8, //全局超时设置,建议大于5 &quot;mongo_config&quot;:{&quot;ip&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:27017,&quot;name&quot;:&quot;&quot;,&quot;password&quot;:&quot;&quot;} //mongodb 配置,ip 端口 name passwrod 空密码时name pwd设置为空 }  设置目标域名文件
{ &quot;domain&quot;:&quot;.qq.com&quot;, //目标域名 必须是.xx.xxx 如.qq.com .163.com .126.net //子域名黑名单,解决泛解析问题 &quot;Blacklist_domain&quot;:[ &quot;."/>







    
</head>
<body>
    <a class="skip-main" href="#main">Skip to main content</a>
    <div class="container">
        <header> 
            
                <h1 class="site-header">
    <a href="/">guimaizi&#39;s blog</a>
</h1>
<nav>
    
    
</nav>

            
        </header>
        <main id="main" tabindex="-1"> 
            

    <article class="post">
        <header>
            <h1>域名收集与监测V3.0</h1>
        </header>
        <div class="content">
            <p>github:https://github.com/guimaizi/get_domain</p>
<h3 id="简介">简介</h3>
<p>在职业刷src或者apt攻击者的角度，单单过一遍爆破的域名是不能满足持续性漏洞挖掘;从职业刷src的角度，过一遍收集的子域名，已经发现了所有漏洞并已经提交后修复，或者用当前漏洞测试方法并没发现有漏洞，这样业务是安全的，但这个安全是在当下时间的，企业要发展、要解决当前问题，就会出新业务、或者不断的修复更新旧问题，这就是业务的变化，通过持续性监控子域名就会发现业务的变化，最快速度的发现变化，对变化进行安全测试、漏洞挖掘。有经验的刷src的同学都知道，新业务发现漏洞概率都很高。</p>
<h3 id="环境配置">环境配置</h3>
<p>需要环境: * win10/8/7/xp<br>
其他请自行修改代码、反正是开源，改动也不大。 * python3<br>
python3.5+ 自行官方下载 * mongodb<br>
自行官方下载 建议docker搭建 参考:https://www.jianshu.com/p/6fdb2bcb4b43 * chrome<br>
自行官方下载 * chromedriver<br>
下载成功后放入python根目录或加入全局环境变量<br>
chromedriver下载地址:http://npm.taobao.org/mirrors/chromedriver/ 注:与当前chrome匹配 * subfinder<br>
<a href="https://github.com/subfinder/subfinder">https://github.com/subfinder/subfinder</a> win默认带有,其他请自行修改代码。 以上配置完成,切进项目目录<br>
pip 安装requirements.txt</p>
<blockquote>
<p>pip install -r requirements.txt</p>
</blockquote>
<p>设置config.json</p>
<pre><code>{
    &quot;path&quot;:&quot;E:/code/test1&quot;, //项目所在绝对路径
    &quot;target_json&quot;:&quot;E:/code/test1/target/qq.json&quot;,   //目标域名文件绝对路径
    &quot;chrome_path&quot;:&quot;C:/Program Files (x86)/Google/Chrome/Application/chrome.exe&quot;, //chrome文件绝对路径
    &quot;timeout&quot;:8, //全局超时设置,建议大于5
    &quot;mongo_config&quot;:{&quot;ip&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:27017,&quot;name&quot;:&quot;&quot;,&quot;password&quot;:&quot;&quot;} //mongodb 配置,ip 端口 name passwrod  空密码时name pwd设置为空
}
</code></pre>
<p>设置目标域名文件</p>
<pre><code>{
&quot;domain&quot;:&quot;.qq.com&quot;,  //目标域名 必须是.xx.xxx 如.qq.com .163.com .126.net
//子域名黑名单,解决泛解析问题
&quot;Blacklist_domain&quot;:[
        &quot;.qzone.qq.com&quot;,
        &quot;.gamebbs.qq.com&quot;,
        &quot;.ke.qq.com&quot;,
        &quot;.house.qq.com&quot;,
        &quot;.auto.qq.com&quot;,
        &quot;.openwebgame.qq.com&quot;,
        &quot;.house.qq.com&quot;,
        &quot;.zhan.qq.com&quot;,
        &quot;.114.qq.com&quot;,
        &quot;.photo.store.qq.com&quot;,
        &quot;.b.qq.com&quot;,
        &quot;.m.qq.com&quot;,
        &quot;.z.qq.com&quot;,
        &quot;.t.qq.com&quot;,
        &quot;.ly.qq.com&quot;,
        &quot;.zg.qq.com&quot;,
        &quot;.3g.qq.com&quot;,
        &quot;.4g.qq.com&quot;,
        &quot;.ia.qq.com&quot;,
        &quot;.city.qq.com&quot;,
        &quot;.photo.qq.com&quot;
    ]
}
</code></pre>
<p>设置fun_all.py第12行</p>
<pre><code>修改对应config.json绝对路径
</code></pre>
<h3 id="运行说明">运行说明</h3>
<p>获取域名http响应结果写入mongodb库 <img src="https://raw.githubusercontent.com/guimaizi/cloud/test/20190614112043.png" alt=""> 获取子域名、子域名管理、子域名监控</p>
<blockquote>
<p>python start.py [argv]<br>
-s 开始通过subfinder爆破获取第一批域名;<br>
-u 调出数据库内domain重新爬行，通过新旧返回值比对，发现业务变化;<br>
-i 导入域名txt字典文件 格式为:xxx.xxx.com;<br>
-iurl 导入url txt文件 格式为:http://xxx.xxx.com/dasd.php;</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/guimaizi/cloud/test/20190624222624.png" alt=""></p>
<h3 id="结果">结果</h3>
<p><img src="https://raw.githubusercontent.com/guimaizi/cloud/test/20190624222715.png" alt=""></p>
<h3 id="码个代码不容易希望有钱人打赏万分感谢">码个代码不容易，希望有钱人打赏,万分感谢。</h3>
<p><img src="https://raw.githubusercontent.com/guimaizi/cloud/test/img/20190301182006.jpg" alt=""></p>

        </div>
        


<div class="article-info">
    
        <div class="article-date">2019-06-25</div>
    
    <div class="article-taxonomies">
        
            <ul class="article-categories">
                
                    <li><a href="http://www.guimaizi.com/categories/%e5%ae%89%e5%85%a8/%e4%bb%a3%e7%a0%81">安全/代码</a></li>
                
            </ul>
            
            
    </div>
</div>

    </article>
    


        </main>
        <footer>
            
                
                

                <p>© 2020<br>
Powered by <a target="_blank" href="https://gohugo.io/">Hugo</a>, theme <a target="_blank" href="https://github.com/mitrichius/hugo-theme-anubis">Anubis</a>.
</p>
            
        </footer>
    </div>
</body>
</html>
